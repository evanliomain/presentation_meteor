'use strict';

// peer dependency
try {
  require('gulp');
}
catch (e) {
  /* istanbul ignore next */
  throw new Error('Please install gulp >=3.8.10');
}

/* istanbul ignore next */
if (process.env.DEBUG)
  Error.stackTraceLimit = Infinity;

var debug = require('debug')('glou');

var $ = require('./plugins');
var initMethod = require('./init-method');

debug('Start');

var glou = module.exports;

// Expose plugins
glou.plugins = $;

// Make all interesting methods global
glou.src = initMethod('src');
glou.dest = initMethod('dest');
glou.configure = initMethod('configure');
glou.pipe = initMethod('pipe');
glou.parallel = initMethod('parallel');
glou.serie = initMethod('serie');
glou.remember = initMethod('remember');
glou.prepend = initMethod('prepend');
glou.append = initMethod('append');

// Helper to access a configuration value
glou.config = require('./config').configGetter;

// Run a pipeline
glou.run = require('./run');

// Register a pipeline in gulp
glou.task = require('./task');

// Watch changes to a list of files & reexecute the tasks linked
glou.watch = require('./watch');
