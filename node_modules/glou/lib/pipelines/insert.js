'use strict';

var _ = require('lodash');

var glou = require('..');

function $initInsert(getArgs) {
  _(arguments).shift();

  // to be rewritten as a proper independent plugin on v2
  var args = getArgs(
    glou
      .pipe(glou.plugins.swallow)
      .pipe.apply(null, arguments)
  );

  return this.parallel.apply(null, args);
}

module.exports.prepend = _.partial($initInsert, function(arg) {
  return [arg, glou.plugins.noop];
});

module.exports.append = _.partial($initInsert, function(arg) {
  return [glou.plugins.noop, arg];
});
